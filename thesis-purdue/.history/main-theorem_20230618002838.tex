\begin{thm}[Takeuchi \cite{Takeuchi-[CharacterizationArithmeticFuchsian]1975}]\label{thm:takeuchi}
  Let $\Gamma$ be a Fuchsian group of the first kind. Then $\Gamma$ is an arithmetic Fuchsian group derived from a quaternion algebra if and only if $\Gamma$ satisfies the following conditions
  \begin{enumerate}
    \item The subfield $k$ of $\Cbb$, generated over $\Qbb$ by the traces of elements of $\Gamma$, has finite degree over $\Qbb$
    \item $\tr(\Gamma)$ is contained in the ring of integers $R_{k}$ of $k$
    \item For any isomorphism $\phi: k \to \Cbb$ such that $\phi \neq \id$, the set $\phi(\tr(\Gamma))$ is bounded in $\Cbb$.
  \end{enumerate}
\end{thm}





\begin{thm}
  Let $A$ be a quaternion algebra over a number field $k$ of Fuchsian (resp. Kleinian) type. Let $\Ocal$ be a maximal order in $A$, and $\afrak$ be an integral ideal in $k$.  Let $\Gamma_O(\afrak)$ be the principal congruence arithmetic lattice in $\SL(2,\Rbb)$ (resp. $\SL(2,\Cbb)$) of level $\afrak$, and let $X(\Gamma_O(\afrak))$ be the associated hyperbolic $2$-orbifold $\Gamma_O(\afrak) \lmod \Hbb^2$ (resp. hyperbolic $3$-orbifold $\Gamma_O(\afrak) \lmod \Hbb^3$). Suppose that
  \begin{enumerate}
    \item A has type number $1$, and
    \item $\afrak$ is not divisible by any prime over which  $A$ is ramified, nor any prime dividing $2$ or $3$.
  \end{enumerate}
  Then $X(\Gamma_O (\afrak))$ is absolutely spectrally rigid.
  % \begin{comment}
  % \sout{Let $\Gamma=\Gamma_{k,A,O}$ denote a maximal arithmetic lattice in $G=\PSL(2,\Rbb)$, arising from the arithmetic datum $(k,A,O)$ (as above) such that $A$ has type number $1$. Let $\afrak$ be a squarefree ideal in $R_k$ which are not divisible by any prime over which $A$ ramifies, nor any dividing $2$ or $3$, the hyperbolic surface $X(\afrak)=\Gamma(\afrak) \lmod G \rmod K$ is absolutely spectrally rigid.}
  % \end{comment}
\end{thm}

\begin{proof}
  First suppose that $A$ is of Fuchsian type, and let $(M,g)$ be a closed Riemannian manifold which is isospectral to $X(\Gamma_0(\afrak))$. By corollary \ref{cor:dimVolTotScal} we  find that $\dim M = \dim X(\Gamma_0(\afrak)) =2$. As $X(\Gamma_0(\afrak))$ has constant scalar curvature $-1$, we may conclude by proposition \ref{prop:curvatureTwoManifolds} that so too does $(M,g)$. By the Uniformization theorem of \ref{prop:uniformization}, there exist a cocompact Fuchsian lattice $\Lambda \leq \SL(2,\Rbb)$ such that $(M,g)$ is isometric to $\Lambda \lmod \Hfrak$. By the Selberg's trace formula, the equality of the Laplace spectra for $\Lambda\lmod \Hfrak $ and $\Gamma_O(\afrak)\lmod \Hfrak$ is equivalent to the equality of their length spectra. From the relation \ref{eq:tracelength} between the length of a geodesic and the trace of the corresponding hyperbolic translation, we conclude the equality of trace sets $\Tr \Lambda = \Tr \Gamma_O (\afrak)$. Applying Takeuci's classification of arithmetic Fuchsian groups of theorem \ref{thm:takeuchi} we find that $\Lambda$ is an arithmetic Fuchsian lattice, and that it is \emph{derived} from its quaternion algebra



  \sout{Suppose $(M,g)$ is a closed Riemannian manifold which is isospectral to $X(\Gamma_O(\afrak))$. By corollary \ref{cor:dimVolTotScal}, we have $\dim M = \dim X(\Gamma_O(\afrak))$. Furthermore, as  $X(\Gamma_0(\afrak))$ has constant scalar (resp. sectional) curvature $-1$ if $A$ is of Fuchsian (resp. Kleinian) type, the same is true of $(M,g)$ by proposition \ref{prop:curvatureTwoManifolds} (resp. \ref{prop:curvatureThreeManifolds}.) Consequently, there exists a lattice $\Lambda$ in $\SL(2,\Rbb)$ (resp. $\SL(2,\Cbb)$) such that $(M,g)$ is isometric to $\Lambda \lmod \Hbb^2$ (resp. $\Lambda\lmod \Hbb^3$).

    From Selberg's trace formula[TODO], the Laplace spectrum of  of $\Lambda \lmod \Hbb^2$ for a cocompact Fuchsian group (resp. $\Lambda \lmod \Hbb^3$ for a cocompact Kleinian group) determines the length (resp. complex length) spectrum.}




  % As $M$ is a compact hyperbolic $2$-manifold, it admits a Fuchsian uniformization $M \approx \Lambda \lmod \Hbb^2$, where $\Lambda$ is a uniform lattice in $\PSL(2,\Rbb)$.
  \begin{claim}
    After conjugating by an element of $\PSL(2,\Rbb)$ we may take $\Lambda$ to be a finite index subgroup of $\Gamma = \rho(O^1) \leq  \PSL(2,\Rbb)$.
  \end{claim}
  \begin{proof}
    This claim follows from two theorems.

    First, we apply the following theorem to conclude that $\Lambda$ is arithmetic.

    The second theorem demonstrates that this quaternion algebra is in fact $A$.
    \begin{thm}[ \cite{Reid-[IsospectralityCommensurabilityArithmetic]1992}]

      Let $M_1$ and $M_2$ be isospectral arithmetic hyperbolic $2$ or $3$ manifolds. Then $M_1$ and $M_2$ are commensurable.
    \end{thm}
    For arithmetic hyperbolic $2$- and $3$-manifolds, commsurability is tantamount to an isomorphism of invariant quaternion algebras.

    From theorem \ref{thm:takeuchi}, $\Lambda$ is contained in $\rho(O'^1)$ for some maximal order $O'$ in $A$. Since $A$ has type number $1$, all maximal orders in $A$ are conjugate (by an element of $A^\times$). Consequently we may take $O'=O$, so that $\Lambda \leq \Gamma = \rho(O^1)$ as claimed.


  \end{proof}
  \begin{lemma}\label{lemma:MangosteenPicosdeEuropa}
    Let $A$ be a quaternion algebra over a number field $k$ with ring of integers $R$, and let $O$ be a maximal order in $A$.
    Let $\pfrak$ be a prime ideal of $R$ over which $A$ is unramified.
    Suppose $\Lambda$ be a subgroup of $O^1$ satisfying
    \begin{align}\label{eq:trace}
      \tr g \equiv 2 \mod \pfrak^{2n}, \quad \text{for all $g \in \Lambda$}.
    \end{align}
    then there exists an $\alpha \in A^\times$ such that $\alpha \Lambda \alpha^\inv \subset O^1(\pfrak^n)$.
  \end{lemma}
  \begin{proof}


    As $A$ is unramified over $\pfrak$, there is an isomorphism
    \begin{align}\label{eq:split}
      O^1 \otimes R_\pfrak \approx SL(2,R_\pfrak)
    \end{align}, and $O^1[\pfrak^n] \approx \SL(2,R/\pfrak^n)$. Fixing an isomorphism in as \ref{eq:split}, we identify $O^1$ with a group of matrices $g = \tbt{a}{b}{c}{d}$ with entries $a,b,c,d \in \R_k$.
    % Picking a uniformizer $\varpi \in R_\pfrak$ for $\pfrak$, each $g\in O^1$ admits a unique decomposition
    % \begin{align}\label{eq:decomposition}
    %     % g                & = g_0 + g_1 \varpi + g_2 \varpi^2 + \dots                                                                \\
    %     \Tbt{a}{b}{c}{d} & =  \Tbt{a_0}{b_0}{c_0}{d_0} +\Tbt{a_1}{b_1}{c_1}{d_1} \varpi + \Tbt{a_2}{b_2}{c_2}{d_2} \varpi^2 + \dots
    % \end{align}
    % $O^1[\pfrak] \approx \SL(2,\kfrak_\pfrak)$
    % for matrices $g_n \in M(2,R_\pfrak)$ at least one of each is not in $\pfrak$.

    We will argue by induction. For the base case, suppose $n=1$ so that $\tr(g) \equiv 2 \mod \pfrak^2$ for all $g \in \Lambda$.


    Write $\Lambda[\pfrak] = \pi_{\pfrak}(\Lambda)\leq \SL(2,\kfrak_\pfrak)$. Now, as $\tr g \equiv 2 \mod \pfrak$ for all $g \in \Lambda$, it follows that each $h \in \Lambda[\pfrak]$ is unipotent.
    Indeed, by Cayley-Hamilton (in $M(2,\kfrak_\pfrak)$) each element $h$ satisfies its characteristic polynomial $p(x;h)=x^2 - \tr h x + 1= (x-1)^2$.
    It follows that $\Lambda[\pfrak]$ is conjugate in $\SL(2,\kfrak_\pfrak)$ to a subgroup of the group $U(\kfrak_\pfrak)$ of upper triangular unipotent matrices. As $O^1 \to O^1[\pfrak]\approx \SL(2,\kfrak_\pfrak)$ is surjective, we may pull back any such conjugation to one in $O^1$.

    Thus, without any loss of generality, we may assume that each $g$ in $\Lambda$ may be written as
    \begin{align*}
      g = \Tbt{1}{x}{0}{1} + \varpi \gamma
    \end{align*}
    for some $\gamma = \tbt{a}{b}{c}{d} \in M(2, R_\pfrak)$.

    Since $\Lambda \leq O^1$, one has $\det g = 1 $ for all $g\in \Lambda$, thus
    \begin{align*}
      1 & = \det g                                     \\
        & = 1 + (a+d - cx ) \varpi + (ad -bc) \varpi^2
    \end{align*}
    so that
    \begin{align}\label{eq:MandarinLeyden}
      (a+d - cx) \varpi + (ad-bc) \varpi^2 =0.
    \end{align}
    By hypothesis (\ref{eq:trace}), we have $(a+d)\varpi = \tr g -2 \equiv 0 \mod \pfrak^2$ so that $a+d \in \pfrak$. Consequently, $xc \in \pfrak$. As $\pfrak$ is prime, it follows that at least one of $x,c$ lies in $\pfrak$. If $x \in \pfrak$, then $g \in O^1(\pfrak)$. If this is so for all $g \in \Lambda$ then the claim is proven. Supposing otherwise, there exists a $ g = \Tbt{1}{x}{0}{1} + \varpi \tbt{a}{b}{c}{d}$ for which $x \in R_\pfrak^\times$. In this case one has $c \in \pfrak$. Let $\alpha_o = \Tbt{\varpi}{0}{0}{1}$. Then
    \begin{align*}
      \alpha_o g\alpha_o^\inv  = \Tbt{1}{\varpi x}{0}{1} + \varpi \tbt{a}{\varpi b}{\varpi^\inv c}{d}
    \end{align*}
    lies in $O^1(\pfrak)$.

    To complete the proof of the base case, we must prove that there exists an element $\alpha \in A^\times $ such that $\alpha g \alpha^\inv =  \alpha_o g \alpha_o^\inv$. Note that multiplying $\alpha_o$ on the left by an element of $\GL(2,R_\pfrak)$ preserves the condition that $\alpha_o g \alpha_o^\inv \in O^1(\pfrak)$, so it suffices to prove that the intersection $\alpha_o \GL(2,R_\pfrak) \cap A^\times $ is nonempty. This, in turn, follows from the fact that $A^\times$ is dense in $\GL(2,k_\pfrak)$ and that the coset  $\alpha_o \GL(2,R_\pfrak)$ is open in $\GL(2,k_\pfrak)$.

    Before we proceed, we need the following lemmata:
    \begin{lemma}\label{lemma:iso}
      Suppose $n\geq 2$. Then there is an isomorphism of $O^1(\pfrak^{n-1}) / O^1(\pfrak^{n})$ with the underlying additive group of $\sl(2,\kfrak_\pfrak)$ which intertwines the conjugation action of $O^1$ on the former with the adjoint action of $O^1$ on the latter.
    \end{lemma}
    \begin{proof}
      The isomorphism is given by composing the map $g = 1 + \varpi^{n-1}\gamma \mapsto \gamma$  of $O^1(\pfrak^{n-1}) \to M(2,R_\pfrak)$ with reduction modulo $\pfrak$.
    \end{proof}

    \begin{lemma}\label{lemma:killingform}
      Let $\Ncal$ be the quadric in $\Pbb(\sl(2,\kfrak_\pfrak))\approx \Pbb^2(\kfrak_\pfrak)$, cut out by the equation $det X =0$. Then $\Ncal$ is a rational normal curve of degree $2$ in $\Pbb^2(\kfrak_\pfrak)$. The action of $\Ad(\SL(2,\kfrak_\pfrak))$ on $\Ncal$ is transitive.

      Consequently, any additive subgroup of $\sl(2,\kfrak_\pfrak)$ consisting of elements satisfying $\det X = 0$ is conjugate via $\SL(2,\kfrak_\pfrak)$ to a subgroup of the form $\Tbt{0}{\kfrak_\pfrak}{0}{0}$.
    \end{lemma}
    Now suppose that $\tr g \equiv 2 \mod \pfrak^{2n}$ for every $g\in \Lambda$. By inductive hypothesis, after conjugating by an element of $A^\times$ if necessary, we may assume $\Lambda \leq O^1(\pfrak^{n-1})$.

    Thus, each element $g\in \Lambda$ can be written as
    \begin{align}\label{eq:AppleWensleydale}
      g = \id +\varpi^{n-1} \gamma
    \end{align}
    for some $\gamma \in M(2, R_\pfrak)$, and the assignment $g \mapsto \gamma \mod \pfrak$ identifies $\Lambda[n] = \Lambda /\Lambda \cap O^1(\pfrak^n)$ with an additive subgroup of $\sl(2,\kfrak_\pfrak)$.

    Note that since $\tr g \equiv 2 \mod \pfrak^{2n}$, one has $\tr(\gamma) \equiv 0 \mod \pfrak^{n+1}$.
    Computing determinants as in \ref{eq:AppleWensleydale},
    \begin{align*}
      1 & = \det g                                                  \\
        & = 1 + \varpi^{n-1} \tr \gamma + \varpi^{2n-2}\det \gamma,
    \end{align*}
    and since $\det g =1$, we find $\tr \gamma +\varpi^{n-1}\det \gamma =0$. From $\tr \gamma  \equiv 0 \mod \pfrak^{n+1}$ we find $ \varpi^{n-1}\det \gamma \equiv 0 \mod \pfrak^{n+1}$, so that $\det \gamma \equiv 0 \mod \pfrak^2$.

    Applying lemma \ref{lemma:killingform}, we may replace $\Lambda$ by an $O^1$-conjugate so that each $g \in \Lambda$ takes the form $g = 1 + \varpi^{n-1}\gamma$ where $\gamma = \tbt{0}{x}{0}{0} +\varpi\delta$ for some $\delta =\tbt{a}{b}{c}{d} \in M(2,\kfrak_\pfrak)$. From
    \begin{align*}
      \det \gamma & = \det (\tbt{0}{x}{0}{0} +\varpi\delta)                              \\
                  & = \varpi^2 \det \delta - \varpi x c  \equiv \varpi xc \mod \pfrak^2,
    \end{align*}
    we find that $xc \equiv 0 \mod \pfrak$, so that either $x$ or $c$ is in $\pfrak$. If $x\in \pfrak$, then $g \in O^1(\pfrak^n)$ already. If this is so for all $g \in \Lambda$, then the claim is proven. Otherwise, suppose $g$ has $x \in R_\pfrak^\times$ so that $c \in \pfrak$. Then, with $\alpha_o = \Tbt{\varpi}{0}{0}{1}$, we find that $\alpha_o g \alpha_o^\inv \in O^1(\pfrak^n)$.

    To complete the proof of the lemma we repeat the argument of the base case to replace $\alpha_o$ with an element $A^\times$.
  \end{proof}




\end{proof}
