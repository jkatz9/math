\subsection{Main Theorem}
\subsubsection*{Definitions}
\begin{comment}
Let $R$ be a commutative ring (with 	$). An algebra $(A,\iota)$ over $R$ is an associative ring $A$ with 	$ equipped with an embedding $\iota : R \to A$ of rings, mapping 	 \in R$ to 	 \in A$ such that $\iota(R)$ is contained in the center of $A$. Using $\iota$, we identify $R$ with a central subring of $A$ and suppress reference to $\iota$.

A \textbf{standard involution} on $B$ is an anti-involution $\overline{\cdot}: A \to A$ such that $x\overline{x} \in A$ for all $x\in A$. Given a standard involution on $A$, define the \textbf{reduced trace},\textbf{reduced norm}, and \textbf{characteristic polynomial} of an element of $A$ by
\begin{align*}
	\trd:         & A \to R, \quad \trd(x)    & = x + \overline{x}         \\
	\nrd:         & A \to R, \quad \nrd(x)    & = x\overline{x}            \\
	\mu(\cdot;T): & A \to R[T] \quad \mu(x;T) & = T^2 - \tr(x) T +\nrd(x).
\end{align*}

\end{comment}
\begin{comment}
In this section $R$ is an integral domain, and $k$ is its field of fractions, and $A$ a finite dimensional algebra over $k$ with unit element 	_A$. A finitely generated $R$-submodule $M$ of $A$ is a \textbf{lattice}, and is \textbf{full} if $kM=A$. A full lattice in $A$ is an \textbf{order} if it is a subring containing 	_A$.

Given a full lattice $M$ in $A$, the sets
\begin{align*}
	\Ocal_\ell(M)= \{ x \in A: xM \subset M\} \\
	\Ocal_r(M)= \{ x \in A: Mx \subset M\}
\end{align*}
are orders in $A$, and are called the \textbf{left}/\textbf{right} orders of $M$ respectively.
\begin{defn}

\end{defn}

\end{comment}
\paragraph{Notation}
Throughout $k$ will denote a number field, and $R$ its ring of integers. We write $V_k$ for its set of places, and write $\nu \in V_k^\infty$ (resp. $\nu \in V_k^f$) if $\nu$ is archimedian (resp. nonarchimedian).
We identify nonarchimedian places $\nu \in V_k^f$ with discrete valuations $\nu : k \to \Zbb$ on $k$ and in turn, prime ideals $\pfrak = \{ x \in k: \nu(x) > 0\}$ in $R$.
For a place $\nu \in V_k$ we write $k_\nu$ for the corresponding local field, and if $\nu \in V_k^f$ corresponding to a prime ideal $\pfrak$ of $R$ we write $R_\nu$ or $R_\pfrak$ for the closure of $R$ in $k_\nu$.
We pick for each finite place $\pfrak$, once and for all, a uniformizer $\varpi \in R_\pfrak$ for its unique maximal ideal.

For an integral ideal $\afrak$ in $R$, we write $\pi_\afrak : R \to R/\afrak$ for the reduction map.
\subsubsection{Theorem}
Let $k \leq \Rbb$ be a totally real number field, and $A$ a quaternion algebra over $k$ which is unramified over the identity embedding $k\to \Rbb$, and ramified over all other infinite places.
If $B$ is a subring of $A$, we write $B^1$ for the multiplicative subgroup of $A^\times$ consisting of elements of $B$ with reduced norm $1$.
An isomorphism $\phi : A\otimes_k \Rbb \to M(2,\Rbb)$ of algebras, restricts to an isomorphism $(A\otimes_k \Rbb)^1 \to \SL(2,\Rbb)$ of groups. Composing $\phi$ with the canonical projection $\SL(2,\Rbb)  \to \PSL(2,\Rbb)$ we obtain a homomorphism $\psi : A^1 \to \PSL(2,\Rbb)$ which factors through $\pm 1 \lmod A^1$.

For an order  $\Ocal \subset A$ in $A$, write $\Ocal^1 = A^1 \cap \Ocal$. We call the subgroup $\psi(\Ocal^1)\leq \PSL(2,\Rbb)$ the arithmetic Fuchsian group associated to the datum $k$,$A$,$\psi$,$\Ocal$.

We write this group as $\Gamma_{k,A,\psi,\Ocal}$, or just by $\Gamma_\Ocal$ if $k,A,\psi$ are fixed. A fuchsian group is \textbf{arithmetic} provided it is commensurable to one of the form $\Gamma_{k,A,\psi,\Ocal}$, and say that it is \textbf{derived} from the quaternion algebra $A$ if is a subgroup of some $\Gamma_{k,A,\psi,\Ocal}$.

\begin{rem}
	Some comments about this definition:
	\begin{enumerate}
		\item Given any Fuchsian group $\Lambda$, there is at most one number field $k$, and quaternon algebra $A$ over $k$, such that $\Lambda$ is commensurable to $\psi(\Ocal^1)$ for some order $\Ocal$ in $A$. Thus, for arithmetic Fuchsian groups, the pair $(k,A)$ is a complete invariant of commensurability classes.
		\item If $\Lambda$ is an arithmetic lattice derived from the quaternion algebra $k,A$, then there are only finitely many orders $\Ocal$ in $A$ such that $\Lambda$ is contained in $\psi(\Ocal^1)$.
		\item For any order $\Ocal$ in a quaterion algebra $A$, the set of maximal orders containing $\Ocal$ is finite and nonempty.
	\end{enumerate}
\end{rem}

For an integral ideal $\afrak$ in $R$, the map $\pi_\alpha: \Ocal \to \Ocal \otimes_R R/\afrak$ is a surjective ring homomorphism.
the \textbf{principal congruence subgroup } of level $\afrak$ in an order $\Ocal$ is the subgroup of $\Ocal^1$ given by
\begin{align*}
	\Ocal^1(\afrak) = \{ x \in \Ocal^1 : x - 1 \in \afrak \Ocal^1\}.
\end{align*}

We let $\pi_\afrak$ denote the projection $\Ocal^1 \to (\Ocal \otimes_R R/\afrak)^1$.   % there is a short exact sequence  \begin{align*} 1 \to \Ocal^1(\afrak) \to \Ocal^1 \to (\Ocal \otimes_R R/\afrak)^1 \to 1 \end{align*}

If $\Lambda$ is any subgroup of $\PSL(2,\Rbb)$ which is commensurable to $\psi(\Ocal^1)$, we write $\Lambda(\afrak,\Ocal)$, or just $\Lambda(\afrak)$ if $\Ocal$ is understood, for
\[\ker \pi_\alpha \vert_\Lambda = \Lambda \cap \psi(\Ocal^1(\afrak)) =\{g \in \Lambda: g \equiv 1 \mod \alpha\}\]
and write $\Lambda[\afrak]$ for its image. Thus,
\begin{align*}
	\Lambda / \Lambda(\afrak) =	\Lambda[\afrak] \leq O^1[\afrak]= O^1/O^1(\afrak)
\end{align*}



% \begin{rem}
% 	The reduction map $R \to R/\afrak$ induces a projection $\Ocal \to \Ocal \otimes_R R/\afrak \approx \Ocal / \afrak \Ocal$ of algebras, and in turn a projection $\pi_\afrak:\Ocal^1 \to (\Ocal \otimes_R R/\afrak)^1$ of groups. Then $\Ocal^1(\afrak) = \ker \pi_\alpha$.
% \end{rem}

% \subsection{Length spectra of arithmetic Fuchsian groups}
% Fix an arithmetic datum $(k,A,\psi,\Ocal)$ as above such that $\Ocal$ is a \emph{maximal order} in $A$, and set $\Gamma = \Gamma_{k,A,\psi,\Ocal}$. In this section, we will compute the length spectrum of the surface $X=\Gamma \lmod \Hbb$ in terms of the arithmetic of $k$.

% \subsubsection*{Geodesics as conjugacy classes}
% The quotient map $\Hbb \to \Gamma \lmod \Hbb = X$ is the universal cover, and identifies $\Gamma$ with $\pi_1(X)$. Consequently, we may identify free homotopy classes of closed curves in $X$ with conjugacy classes in $X$. As $X$ has negative curvature, there is a unique geodesic representative in each free homotopy class on $X$. Thus, we may identify the set of geodesics on $X$ with conjugacy classes in $\Gamma$. Given a conjugacy class $\gamma \subset \Gamma$, we write $\ell(\gamma)$ for the length of the corresponding geodesic.  Each $g\in \gamma$ has a unique lift $\tilde{g}$ to $\SL(2,\Rbb)$ with positive trace. We write $\tr(g)$ for $\tr(\tilde{g})$, and set
% \begin{align*}
% 	\lambda_g = \frac{t_g + \sqrt{t_g^2 - 4}}{2}.
% \end{align*}
% Then the length of the geodesic corresponding to $\gamma$ is related to $\lambda_g$ by the formula:
% \begin{align*}
% 	\lambda_g^2 = \exp(\ell(g)).
% \end{align*}

% \subsubsection*{Conjugacy classes in quaternion algebras and orders}
% In this section $F$ is a number field with number field $R$, $A$ a quaternion algebra over $F$, and $\Ocal$ a maximal order in $A$.

% The algebra $A$ is equipped with an (anti-)involution $\overline{\cdot}$ and reduced norm/trace maps:
% \begin{align*}
% 	\trd(x) & = x+\overline{x} \\
% 	\nrd(x) & = x\overline{x},
% \end{align*}
% and every element $x\in A$ satisfies its characterstic polynomial
% \begin{align*}
% 	\chi(x;T)= T^2 - \trd(x) T + \nrd (x).
% \end{align*}

% Given an element $x\in A$, let $F[x] \subset A$ be the smallest $F$-subalgebra of $A$ containing $x$.
% \begin{claim}
% 	For $x\in A$, set $\delta=\delta(x)$
% 	\begin{align*}
% 		F[x] \approx \begin{cases}
% 			             F                 & \text{ if $x\in F$}                                                     \\
% 			             F \oplus F        & \text{if $\delta \in  (F^\times)^2$ and $x\notin F$}                    \\
% 			             F[\sqrt{\delta}]  & \text{if $\delta \in  F^\times \setminus (F^\times)^2$ and $x\notin F$} \\
% 			             F[\eps]/(\eps^2 ) & \text{if $\delta=0$ and $x\notin F$},
% 		             \end{cases}
% 	\end{align*}
% 	as $F$-algebras.
% \end{claim}
% We say $x\in A$ is semsimple in the first three cases, and regular semisimple in the second and third cases.

% \begin{claim}
% 	If $x \in A^\times$ is noncentral, then the centralizer of $x$ in $A^\times$ is $F[x]^\times$.
% \end{claim}

% We view $A$ as four dimensional affine space over $F$, and write $F[A]$ for its coordinate ring. Then $A^\times$ is the principal open subvariety of $A$ defined by the nonvanishing of $\nrd$. Its coordinate ring  $F[A^\times]$ is the localization $F[A]_{\nrd} = F[A,\nrd^{\inv}]$ of $F[A]$ away from the zero locus of $\nrd$.

% For $g \in A^\times$ and $f\in F[A]$ or $F[A^\times]$, write  $f^g$ for the function $x \mapsto  f( g x g^\inv)$. For $x\in A$, write $O(x) = \{ x^g : g \in A^\times\}\subset A$ for its orbit under conjugation by $A^\times$.

% \begin{claim}\label{orbits}
% 	For noncentral $x\in A^\times$, the orbit $O(x)$ is Zariski-closed in $A$ (and $A^times$) if and only if $x$ is not parabolic. All parabolic elements in $A^\times$ constitute a single conjugacy class, and the Zariski closure of this class is zero locus of $\delta = \trd^2-4\nrd$.
% 	% say $\Ucal$. The complement of $\Ucal$ in its Zariski closure $\overline{\Ucal}$ is the center $F^\times$ of $A^\times$. 
% \end{claim}
% \begin{claim}
% 	\begin{enumerate}
% 		\item The algebra $F[A]^{A^\times}$ of invariants in $F[A]$  under $A^\times$ is generated as an $F$ algebra by $\trd$ and $\nrd$.
% 		\item The map $(\trd,\nrd):A \to \Abb_F^2$ dual to the inclusion $F[A]^{A^\times} \to F[A]$ is a GIT quotient for the conjugation action of $A^\times$ on $A$ in the sense that its fibers are Zariski closures of conjugacy classes.
% 		\item The restriction of $(\trd,\nrd)$ to the open subset $A^{*}$ of regular semisimple elements is a genuine orbit map, in the sense that its fibers are $A^\times$ conjugacy classes in $A$.
% 	\end{enumerate}
% \end{claim}


\begin{thm}
	Let $\Gamma=\Gamma_{k,A,O}$ denote a maximal arithmetic lattice in $G=\PSL(2,\Rbb)$, arising from the arithmetic datum $(k,A,O)$ (as above) such that $A$ has type number $1$. Let $\afrak$ be a squarefree ideal in $R_k$ which are not divisible by any prime over which $A$ ramifies, nor any dividing $2$ or $3$, the hyperbolic surface $X(\afrak)=\Gamma(\afrak) \lmod G \rmod K$ is absolutely spectrally rigid.
\end{thm}
\begin{proof}
	In what follows, we suppose $M$ is a closed Riemannian manifold which is isospectral to $X(\afrak)$.

	\begin{claim}\label{claim:heat}
		The dimension, volume, and mean scalar curvature of $M$ and $X(I)$ coincide.
	\end{claim}



	\begin{lemma}
		Let $X$ be a Riemannian manifold, with Laplace spectrum $0\geq \lambda_0 \geq \lambda_1 \geq \cdots$, and let $K_X(t)=\sum_{i=1}^\infty e^{\lambda_i t}$. Then $K_X(t)$ admits an asymptotic expansion as $t\to 0^+$ of the form
		\[ K_X(t) \sim (4\pi t)^{-\dim(X)/2} \sum_{n=0}^\infty a_n(X) t^n \]
		for constants $a_i(X)$ which are integrals over $X$ of polynomials in the entries of the curvature tensor of $X$ and its covariant derivatives. The first two are:
		\[a_0(X) = \Vol(X),\quad a_1(X) = \frac{1}{6} \int_X \tr {\rm Ricc} (x) \dop \Vol(x).\]
	\end{lemma}

	Indeed, since $K_M(t) = K_{X(I)}(t)$ identically, we may read off the invariants in the claim from their common asymptotic expansions as $t\to 0^+$.
	\begin{rem}
		The total scalar curvature of a smooth, closed surface is its Euler characteristic by Gauss-Bonnet. As the euler characteristic is a complete invariant of the diffeomorphism type for closed surfaces, we may thus conclude that $M$ and $X(I)$ are in fact diffeomorphic.
	\end{rem}

	[TODO]: argue that $M$ must have constant negative curvature $=-1$. We'll do so either via one of the following routes:
	% \begin{itemize}
	% 	\item look at the the full set of heat invariants, and argue that they detect variation in curvature eventually
	% 	\item apply the theorem of patodi which says that if a closed $d$ manifold $X$ has constant negative curvature, and $M$ is isospectral to $X$ on $p$-forms for $0\leq p \leq d$, then $M$ also has constant negative curvature. Need to argue tho that isospectrality on $0$ forms implies the same for $1$ forms on surfaces (is this true in general?)
	% 	\item apply the theorem of BCG which says that, at least for closed $2$ manifolds, within a conformal class of metrics on a closed surface $X$ with fixed volume, the entropy of the geodesic flow is minimized at the unique metric of constant curvature. Here we need to argue that that entropy is, in fact, a spectral invariant.
	% \end{itemize}


	As $M$ is a compact hyperbolic $2$-manifold, it admits a Fuchsian uniformization $M \approx \Lambda \lmod \Hbb^2$, where $\Lambda$ is a uniform lattice in $\PSL(2,\Rbb)$.
	\begin{claim}
		After conjugating by an element of $\PSL(2,\Rbb)$ we may take $\Lambda$ to be a finite index subgroup of $\Gamma = \rho(O^1) \leq  \PSL(2,\Rbb)$.
	\end{claim}
	\begin{proof}
		This claim follows from two theorems.

		First, we apply the following theorem to conclude that $\Lambda$ is arithmetic.
		\begin{thm}[Takeuchi \cite{takeuchiCharacterizationArithmeticFuchsian1975}]\label{thm:takeuchi}
			Let $\Gamma$ be a Fuchsian group of the first kind. Then $\Gamma$ is an arithmetic Fuchsian group derived from a quaternion algebra if and only if $\Gamma$ satisfies the following conditions
			\begin{enumerate}
				\item The subfield $k$ of $\Cbb$, generated over $\Qbb$ by the traces of elements of $\Gamma$, has finite degree over $\Qbb$
				\item $\tr(\Gamma)$ is contained in the ring of integers $R_{k}$ of $k$
				\item For any isomorphism $\phi: k \to \Cbb$ such that $\phi \neq \id$, the set $\phi(\tr(\Gamma))$ is bounded in $\Cbb$.
			\end{enumerate}
		\end{thm}
		As these conditions are satisfied for $\Gamma(I)$, and $\tr(\Gamma(I)) = \tr(\Lambda)$, there are also satisfied for $\Lambda$. Thus, $\Lambda$ is a finite index subgroup of the norm one units of \emph{some} maximal order in \emph{some} quaternion algebra over $k$.

		The second theorem demonstrates that this quaternion algebra is in fact $A$.
		\begin{thm}[Reid \cite{reidIsospectralityCommensurabilityArithmetic1992}]
			Let $M_1$ and $M_2$ be isospectral arithmetic hyperbolic $2$ or $3$ manifolds. Then $M_1$ and $M_2$ are commensurable.
		\end{thm}
		For arithmetic hyperbolic $2$- and $3$-manifolds, commsurability is tantamount to an isomorphism of invariant quaternion algebras.

		From theorem \ref{thm:takeuchi}, $\Lambda$ is contained in $\rho(O'^1)$ for some maximal order $O'$ in $A$. Since $A$ has type number $1$, all maximal orders in $A$ are conjugate (by an element of $A^\times$). Consequently we may take $O'=O$, so that $\Lambda \leq \Gamma = \rho(O^1)$ as claimed.


	\end{proof}

	% From claim \ref{claim:heat},  $\vol(\Lambda \lmod \Hbb^2) = \vol(\Gamma(I) \lmod \Hbb^2)$ and each of these is equal to the respective group's index in $\Gamma$, we find $|\Gamma: \Gamma(I)| = |\Gamma: \Lambda|$.

	% \begin{rem}
	% 	As $\Gamma(I)$ and $\Lambda$ are both contained in $\Lambda = PO^1 = \pm 1 \lmod O^1$, there is no harm in lifting everything to $O^1$. We do so, and reuse the same notation for lifts.
	% \end{rem}



	\begin{comment}
	At this point, we do not know if $\Lambda$ is a \emph{congruence} subgroup of $\Gamma$. That is, we do not know if $\Lambda = A^1 \cap \prod_{\pfrak} \Clo_\pfrak(\Lambda) = \Lambda$ (product taken inside $(A\otimes \Abb_k)^1$)

	(Equivalently, we do not know if $\Gamma(J) \leq \Lambda$ for some ideal $J$ of $R$)
	\end{comment}
	\input{trace-lemma.tex}