\documentclass[11pt]{amsart}
\usepackage{geometry}                % See geometry.pdf to learn the layout options. There are lots.
\geometry{letterpaper}                   % ... or a4paper or a5paper or ... 
%\geometry{landscape}                % Activate for for rotated page geometry
%\usepackage[parfill]{parskip}    % Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx}
\usepackage{amssymb}
\usepackage{epstopdf}
\DeclareGraphicsRule{.tif}{png}{.png}{`convert #1 `dirname #1`/`basename #1 .tif`.png}
\input{mydefs}

\title{Zeta functions of real quadratic fields as periods of Eisenstein series}
\author{Justin Katz}
%\date{}                                           % Activate to display a given date or no date

\begin{document}
\maketitle

\section{Introduction}

Set $k=\Q(\sqrt{D})$ and $\intring_k$ its the ring of integers. The zeta function attached to $k$ is
\begin{equation*}
\zeta_k(s)=\sum_{\gothic{a}\subset \intring_k} \frac{1}{|N(\gothic{a})|^{-s}}
\end{equation*}
where the sum is over nonzero integral ideals in $\intring_k$ and $\re(s)>1$. A suitable modification of Riemann's argument for the continuation of $\zeta=\zeta_\Q$ shows that $\zeta_k$ has meromorphic continuation to the entire $s$-plane.

Let $G=\SL_2(\R)$, $\Gamma=\SL_2(\Z)$, and $P$ be the parabolic of upper triangular elements of $\SL_2(\R)$. As usual, $G$ acts on the upper half plane $\half$ by fractional linear transformations. The for complex $s$ with $\re(s)>1$, the $s^{th}$ Eisenstein series on the upper half plane is
\begin{equation*}
E_s(z)=\sum_{\gamma \in (P\cap \Gamma)\backslash \Gamma} (\im(\gamma z))^s,
\end{equation*}
which is $\Gamma$-invariant by design. For fixed $z$, the map $s\mapsto E_s(z)$ has meromorphic continuation to the entire $s$-plane.

This writeup shows that $\zeta_k$ is a sum of integrals of Eisenstein series over closed geodesics.

\section{Real quadratic}
In this section $k=\Q(\sqrt{D})$ with $D<0$. As a $\Q$ module, $k$ is $\Q^2$. The multiplicative subgroup $k^\times$ acts transitively on $\Q^2$. Choose the basis $\{\sqrt{D},1\}$ and compute for $a+b\sqrt{D}\in k^\times$,
\begin{align*}
(a+b\sqrt{D}) \times \sqrt{D}&= a\cdot \sqrt{D} + bD \cdot 1  \\
(a+b \sqrt{D}) \times 1        &=  b \cdot \sqrt{D} + a \cdot 1 .
\end{align*}
In coordinates, we have an embedding
\begin{align*}
k^\times &\to \GL_2(\Q) \\ 
a+b\sqrt{D} &\mapsto   \begin{pmatrix}
    a & b D \\ 
    b & a     \end{pmatrix}
\end{align*}
Let $G'$ be the image of $k^\times$ in $\GL_2(\Q)$. Note that the determinant of the image of $a+b \sqrt{D}$ is $a^2-b^2 D=N(a+b\sqrt{D})$. The existence of nontrivial units in $\intring_k$ implies that the subgroup $H'=G'\cap G$ is nontrivial. As a subgroup of $G=\SL_2(\R)$, the group $H'$ sensibly acts on the upper half-plane. Taking the trace of a generic matrix  $ Tr \begin{pmatrix}
    a & b D \\ 
    b & a     \end{pmatrix}=2a$ and recalling that the units of $\intring_k$ are integral shows that all nonidentity elements of $H_1$ are hyperbolic. As such, any nonidentity element of $H'$ fixes two distinct points on $\R \cup \{ \infty \}$.

Although $H'$ is discrete in $G$, it lies in a one parameter subgroup $H$ of $G'$ defined by parameterizing the solutions of $a^2-b^2 D=1$ viz
\begin{equation*}
H'\subset H=\{ \begin{pmatrix}
    \cosh(t) & \sinh(t)\sqrt{D} \\ 
    \sinh(t)/\sqrt{D} & \cosh(t)     \end{pmatrix} : \hspace{10pt} t\in \R \}
\end{equation*}
In fact, $H'=H\cap \Gamma$. Denote an element of $H$ by $h_t$. One can compute that each $h_t$ fixes $-\sqrt{D}$ and $\sqrt{D}$. Consequently, $H$ fixes the geodesic $\mathcal{C}_{\sqrt{D}}$ running from $-\sqrt{D}$ to $\sqrt{D}$, set-wise. In particular, the radius of the semicircle defining $\mathcal{C}_{\sqrt{D}}$ is $\sqrt{D}$, so the point $i\sqrt{D}\in\mathcal{C}_{\sqrt{D}}$.  Pointwise, each $h_t$ translates a point rightward along $\mathcal{C}_{\sqrt{D}}$. The orbit of $i \sqrt{D}$ under the nontrivial discrete subgroup $H'=H\cap \Gamma$ partitions the orbit $H \cdot i\sqrt{D}$ into congruent intervals. The resulting quotient $H'\backslash H \cdot i\sqrt{D}$ is compact. Paul Garrett showed for a real quadratic field with principal integer ring that 
\begin{equation*}
2^s \frac{\sqrt{D}^s\Gamma(\frac{s}{2})\Gamma(\frac{s}{2})}{\Gamma(s)} \frac{\zeta_k(s)}{\zeta(s)}=\int_{H'\backslash H}E_s(h\cdot i \sqrt{D}) dh.
\end{equation*}
The fact that the right side of the above is a single integral amounts to the principality of the ring of integers.

Suppose $\intring_k$ is not principal. As with imaginary quadratic fields,  each class of ideals, equivalent under multiplication by $k^\times$, corresponds to a class of quadratic forms with discriminant $D$, equivalent under change of basis by $\SL_2(\Z)$. Unlike imaginary quadratic fields, these quadratic forms are indefinite. Thus, the sum over ideals in $\zeta_k$ is equivalently a sum over quadratic forms. As we can decompose the sum over ideals into a sum over classes, then over representatives, we can do the same with quadratic forms. 

Let $Q(m,n)=A m^2 +B mn+C n^2$ of discriminant $D$. Dehomogenizing the quadratic form gives a polynomial $Az^2+Bz+C$ which has real roots $\frac{-B \pm \sqrt{D}}{2A}$. Without loss of generality let $\frac{-B - \sqrt{D}}{2A}<\frac{-B + \sqrt{D}}{2A}$ and call the former $\alpha$. We will find that integrating $E_s(-\cdot \alpha)$ over a conjugate of $H$ will yield the desired sum over the class of quadratic forms containing $Q$. 

The transformation $a=\tbt{2 A}{-B}{0}{1}\in \GL_2(\Q)$ takes $\alpha$ to $-\sqrt{D}$ and $\bar{\alpha}$ to $\sqrt{D}$. The whole group $H$ fixes $\pm \sqrt{D}$, so the conjugate
\begin{equation*}
H_\alpha=a^{-1} H a = \Tbt{\cosh(t)-B \sinh(t)/\sqrt{D}}{-2C \sinh(t)/\sqrt{D}}{2A \sinh(t)/\sqrt{D}}{\cosh(t)+B\sinh(t)/\sqrt{D}}
\end{equation*}
fixes $\alpha$ and $\bar{\alpha}$. As above, $H_\alpha$  setwise fixes the geodesic $\mathcal{C}_\alpha$ running from $\alpha$ to $\bar{\alpha}$, and pointwise shifts to the right. The geodesic $\mathcal{C}_\alpha$ has radius $(\alpha-\bar{\alpha})/2=\frac{\sqrt{D}}{2A}$ and is centered about $(\alpha+\bar{\alpha})/2=-\frac{B}{2A}$, so the point $z_\alpha=\frac{-B+i\sqrt{D}}{2A}$ is on $\mathcal{C}_\alpha$. The discrete subgroup $H'_\alpha=H_\alpha \cap \SL_2(\Z)$  partitions the geodesic $\mathcal{C}_\alpha=H_\alpha z_\alpha$ into compact intervals, so the quotient $H'_\alpha \backslash H_\alpha z_\alpha$ is compact. Now the integral of the Eisenstein series decomposes
\begin{align*}
\int_{H'_\gothic{a} \backslash H_\gothic{a}}E_s(h_\gothic{a} \cdot z_\alpha) dh_\gothic{a} & =\int_{H'_\gothic{a} \backslash H_\gothic{a}} \sum_{\gamma \in P \cap \Gamma \backslash \Gamma} \im (\gamma h_\gothic{a} \cdot z_\alpha) dh_\gothic{a} \\
& = \sum_{x \in \Gamma \cap P \backslash \Gamma / H'_\alpha} \int_{H'_\gothic{a} \backslash H_\gothic{a}} \sum_{y \in (x^{-1} (\Gamma \cap P) x \cap H_\alpha) \backslash H'_\alpha} \im(x y h_\gothic{a} \cdot z_\alpha) dh_\gothic{a}.
\end{align*}
by considering which $y,y'\in$ make $(\Gamma \cap P)x(H'_\alpha)y=(\Gamma \cap P)x(H'_\alpha)y'$. The integral parabolic has eigenvalues $\pm 1$. The eigenvalues of $H$ are nontrivial units (this follows from the definition of the embedding of $k^\times$, or an easy calculation), and $H_\alpha$ is conjugate to $H$ so it has the same eigenvalues. Thus, the intersection in the inner sum is $\{ \pm \id \}$. Accordingly, the integral unwinds
\begin{align*}
\int_{H'_\gothic{a} \backslash H_\gothic{a}}E_s(h_\gothic{a} \cdot z_\alpha) dh_\gothic{a}& =  \sum_{x \in \Gamma \cap P \backslash \Gamma / H'_\alpha} \int_{\{\pm \id \} \backslash H_\gothic{a}} \im(x h_\gothic{a} \cdot z_\alpha) dh_\gothic{a}.
\end{align*}
Recall that modulo the integral parabolic, $\Gamma$ is coprime bottom rows. Dividing by $2\zeta(s)$ gives as usual 
\begin{equation*}
\int_{H'_\gothic{a} \backslash H_\gothic{a}}E_s(h_\gothic{a} \cdot z_\alpha) dh_\gothic{a} =  \frac{1}{2 \zeta (2s)} \sum_{\{ (m,n)\neq 0 \} / H'_\alpha} \int_{\{\pm \id \} \backslash H_\gothic{a}} \frac{\im( h_\gothic{a} z_\alpha)}{|m h_\gothic{a} z_\alpha+n|} dh_\gothic{a}.
\end{equation*}
For brevity, let $u=\cosh t$ and $v=\sinh t$. Taking the imaginary part in the numerator amounts to multiplying the denominator by the action of the lower row, as usual. The denominator is
\begin{align*}
&|m((u -B v/\sqrt{D})z_\alpha-2 C v/\sqrt{D} )+n(2Av z_\alpha/\sqrt{D}   +u+B v/\sqrt{D} )|^{2s} \\
 &=|(m(u -B v/\sqrt{D})+2Anv/\sqrt{D})\frac{-B}{2A}-2 C m v/\sqrt{D}+n(u+B v/\sqrt{D})\\
 & +\frac{i\sqrt{D}}{2A}(m(u-Bv/\sqrt{D})+2Anv/\sqrt{D})|^{2s} \\
 &= |\frac{-m}{2A}(Bu-\sqrt{D} v)+nu +i(\frac{m}{2A} (u\sqrt{D}-Bv)+nv)|^{2s} \\
 \end{align*}
 Taking the absolute value,
 \begin{align*}
(\frac{m}{2A}(\sqrt{D} v-Bu)+nu)^2+(\frac{m}{2A} (u\sqrt{D}-Bv)+nv)^2 &= \frac{m^2}{4A^2} (D(u^2+v^2)-4B\sqrt{D} v u + B^2(v^2+u^2))\\
	&- \frac{mn}{A}(Bu^2-2\sqrt{D}uv+B v^2) \\
	&+ n^2(u^2+v^2)
\end{align*}
Recall that $u^2+v^2=\cosh^2 t+\sinh^2 t=(e^{2t}+e^{-2t})/4$ and $uv=(e^{2t}-e^{2t})/4$ so
\begin{align*}
(\frac{m}{2A}(\sqrt{D} v-Bu)+nu)^2+(\frac{m}{2A} (u\sqrt{D}-Bv)+nv)^2 &= 2 (\frac{D-2B\sqrt{D}+B^2}{4A^2}m^2-\frac{B-\sqrt{D}}{A}mn +n^2)e^{2t} \\
&+2 (\frac{D+2B\sqrt{D}+B^2}{4A^2}m^2-\frac{B+\sqrt{D}}{A}mn +n^2)e^{-2t}\\
&=2 (\alpha ^2 m^2 +2 \alpha mn +n^2)e^{2t} \\
&+2 (\overline{\alpha} ^2 m^2 +2 \overline{\alpha} mn +n^2)e^{-2t}
\end{align*}
Where $\alpha=\frac{-B-\sqrt{D}}{2A}$. To summarize, each integrand in the sum is
\begin{align*}
 \frac{(\im h_\gothic{a} z_\alpha)^{s}}{|m h_\gothic{a} z_\alpha+n|^{2s}}=2^{-s}\frac{\sqrt{D}^s/(2A)^s}{((\alpha m +n)^2e^{2t}+(\overline{\alpha} m +n)^2e^{-2t})^s}.
\end{align*}
Thus, the integral to compute is 
\begin{align*}
\int_{-\infty}^{\infty} \frac{dt}{(X e^{2t}+Y e^{-2t})^s}.
\end{align*}
Following Paul Garrett, recall 
\begin{align*}
y^{-s}\Gamma(s) =y^{-s} \int_{0} ^{\infty} u^s e^{-u} \frac{du}{u} =\int_{0} ^{-\infty} u^s e^{-u \cdot y} \frac{du}{u},
\end{align*}
specifically:
\begin{align*}
\Gamma(s)\int_{-\infty}^{\infty} \frac{dt}{(Xe^{2t}+Ye^{-2t})^s}=\int_{-\infty}^{\infty} \int_0 ^{\infty} u^s e^{-u(Xe^{2t}+Ye^{-2t})} \frac{du}{u} dt.
\end{align*}
Change to multiplicative coordinates in the outer integral via $t=\frac{\log v}{2}$, and then change $u$ to $uv$, making the above
\begin{align*}
\frac{1}{2} \int_{-\infty}^{\infty} \int_0 ^{\infty} u^s e^{-u(Xv+Yv^{-1})} \frac{du}{u} \frac{dv}{v} = \frac{1}{2} \int_{-\infty}^{\infty} \int_0 ^{\infty} u^s v^s e^{-u(Xv^2+Y)} \frac{du}{u} \frac{dv}{v}.
\end{align*}
Now change $v$ to $\sqrt{v}$, then $v$ by $uv$ so 
\begin{align*}
\frac{1}{4} \int_{-\infty}^{\infty} \int_0 ^{\infty} u^s v^{s/2} e^{-u(Xv+Y)} \frac{du}{u} \frac{dv}{v}= \frac{1}{4} \int_{-\infty}^{\infty} \int_0 ^{\infty} u^{s/2} v^{s/2} e^{-(Xv+Yu)} \frac{du}{u} \frac{dv}{v}.
\end{align*}
Finally, change $v$ to $v/X$ and $u$ to $u/Y$ to get
\begin{align*}
\int_{-\infty}^{\infty} \frac{dt}{(Xe^{2t}+Ye^{-2t})^s}=\frac{\Gamma(s/2)\Gamma(s/2)}{4 \Gamma(s)}X^{-s/2}Y^{-s/2}.
\end{align*}
Specify to the problem at hand,
\begin{align*}
\int_{ {\pm \id} \backslash H_\alpha} \frac{(\im h_\gothic{a} z_\alpha)^{s}}{|m h_\gothic{a} z_\alpha+n|^{2s}}& =2^{-s}\sqrt{D}^s\int_{-\infty}^{\infty} \frac{dt}{( 2A(\alpha m +n)^2e^{2t}+2A(\overline{\alpha} m +n)^2e^{-2t})^s} \\
&= \frac{\Gamma(s/2)\Gamma(s/2)}{4 \Gamma(s)}(2A\alpha\overline{\alpha} m^2 +4A (\alpha + \overline{\alpha})mn +2A n^2)^{-s} \\
&= \frac{\Gamma(s/2)\Gamma(s/2)}{4 \Gamma(s)}(C m^2 +B m n + A n^2)^{-s}.
\end{align*}
That is, the sum of the integrals is
\begin{align*}
\sum_{\{ (m,n)\neq 0 \}/ H'_\alpha} \int_{ {\pm \id} \backslash H_\alpha} \frac{(\im h_\gothic{a} z_\alpha)^{s}}{|m h_\gothic{a} z_\alpha+n|^{2s}} =   \frac{\Gamma(s/2)\Gamma(s/2)}{4 \Gamma(s)} \sum_{\{ (m,n)\neq 0 \}/ H'_\alpha}\frac{1}{|C m^2 +B m n + A n^2|^{s}}.
\end{align*}
We recognize the latter as a sum over a quadratic form, which corresponds to a sum over a norm of a class of ideals. The index of the sum can be viewed as integral bases, modulo norm $1$ units. Thus, by integrating the Eisenstein series over a suitable closed geodesic, we can obtain the sum over any class of ideals.
\end{document}  